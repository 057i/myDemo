var IndexControl,list,len,$=window.Zepto,root=window.player,nowIndex=0,audioPlayer=new root.audioControl,rotateDom=new root.rotateAlbum($(".img-box"));function bingEvent(a){$(".control").on("click",".pre",function(){0==nowIndex?nowIndex=len-1:nowIndex--;var o=audioPlayer.audio.status;root.render(a[nowIndex]),audioPlayer.setSource(a[nowIndex].audio),audioPlayer.audio.status=o,"play"==audioPlayer.audio.status&&(audioPlayer.audio.status="continue",$(".play").click()),rotateDom.change(),root.pro.renderAllTime(a[nowIndex].duration)}).on("click",".play",function(){"play"==audioPlayer.audio.status?(audioPlayer.pause(),rotateDom.stop(),root.pro.stop()):"pause"==audioPlayer.audio.status?(audioPlayer.play(),rotateDom.con(),root.pro.start()):"continue"==audioPlayer.audio.status&&(audioPlayer.audio.status="play",audioPlayer.play(),rotateDom.stop(),rotateDom.num=0,rotateDom.change(),rotateDom.con(),root.pro.stop()),"play"==audioPlayer.audio.status?$(".play").addClass("pause"):$(".play").removeClass("pause")}).on("click",".next",function(){nowIndex==len-1?nowIndex=0:nowIndex++;var o=audioPlayer.audio.status;root.render(a[nowIndex]),audioPlayer.setSource(a[nowIndex].audio),audioPlayer.audio.status=o,"play"==audioPlayer.audio.status&&(audioPlayer.audio.status="continue",$(".play").click()),root.pro.renderAllTime(a[nowIndex].duration),root.pro.reset(),rotateDom.change()})}function proControl(){var o=$(".total-progress").offset(),n=o.left,r=o.width;$("#spot").on("touchstart",function(o){root.pro.stop(),audioPlayer.pause()}).on("touchmove",function(o){var a=(o.changedTouches[0].clientX-n)/r;0<=a&&a<1&&root.pro.update(a)}),$("#spot").on("touchend",function(o){var a=(o.changedTouches[0].clientX-n)/r;if(0<=a&&a<1){var t=list[nowIndex].duration,e=Math.round(t*a);audioPlayer.playTo(e),audioPlayer.play(),audioPlayer.status="play",root.pro.start(a)}})}function getDate(o){$.ajax({type:"GET",url:o,success:function(o){bingEvent(o),proControl(),len=(list=o).length,root.render(o[0]),audioPlayer.setSource(o[nowIndex].audio),root.pro.renderAllTime(o[nowIndex].duration)},error:function(){console.log("error")}})}getDate("../mook/data.json");